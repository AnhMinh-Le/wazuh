# Configuration 

The **Vulnerability Scanner** has a dedicated configuration block with minimal options to configure. The module is simple and works out of the box and it does not require bigger tweaks.

```xml
<vulnerability-detection>
    <enabled>yes</enabled>
    <index-status>yes</index-status>
    <feed-update-interval>60m</feed-update-interval>
    <!--<offline-url>file:///home/vagrant/content_custom.json</offline-url>-->
</vulnerability-detection>
```

**feed-update-interval**: Default and minimum value, 60 min.
**offline-url**: Option hidden by default to generate a CVE database from offline content. It won't be updated.

## Connection to Wazuh Indexer

As mentioned above, the Vulnerability Scanner indexed its data to the Wazuh Indexer through the Indexer Connector module.

- Default Indexer Connector configuration block
```xml
  <indexer>
    <enabled>yes</enabled>
    <hosts>
      <host>https://0.0.0.0:9200</host>
    </hosts>
    <ssl>
      <certificate_authorities>
        <ca>/etc/filebeat/certs/root-ca.pem</ca>
      </certificate_authorities>
      <certificate>/etc/filebeat/certs/filebeat.pem</certificate>
      <key>/etc/filebeat/certs/filebeat-key.pem</key>
    </ssl>
  </indexer>
```

It is important to verify the status of the Wazuh Indexer **GET /_cluster/health**

- e.g. Response
```json
{
  "cluster_name": "wazuh-cluster",
  "status": "green",
  "timed_out": false,
  "number_of_nodes": 1,
  "number_of_data_nodes": 1,
  "discovered_master": true,
  "discovered_cluster_manager": true,
  "active_primary_shards": 15,
  "active_shards": 15,
  "relocating_shards": 0,
  "initializing_shards": 0,
  "unassigned_shards": 0,
  "delayed_unassigned_shards": 0,
  "number_of_pending_tasks": 0,
  "number_of_in_flight_fetch": 0,
  "task_max_waiting_in_queue_millis": 0,
  "active_shards_percent_as_number": 100
}
```

**Currently the module does not allow insecure connection, so it is important to verify carefully the indexer connector configuration**

## Data to index

The **Vulnerability Scanner** receives operating system and packages events that will be processed against a CVE database and hotfixes (only for Windows) information to detect vulnerabilities that will be indexed through the indexer connector. 
